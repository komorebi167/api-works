# api-works

ここは、自作APIを整理して置いておく場所です。  
ちょっとした処理の断片から、いくつかの機能を組み合わせたものまで、  
使いやすさや再利用しやすさを意識してまとめています。  
誰かと共有することも考えながら、役割や使い方がはっきりするようにしています。

## 運用方針と使い方

このリポジトリでは、各APIを独立した構成で管理しています。  
それぞれが `.env` ファイルを持ち、責務を分離した設計になっています。  
本番環境では ConoHa WING 上で運用することを前提とし、セキュリティと再利用性を両立する構成を採用しています。

## 🚀 使い方（本番環境でのデプロイ手順）

1. **API本体のファイルをアップロード**  
   - 各APIをフォルダごと、使用したいプロジェクトフォルダ内に配置  
   - 例：`public_html/hoge.example.com/myproject/backend/api1/`  
   - ※ これは例です。実際の環境に応じて置き換えてください。以下同様。

2. **各APIに対応する `.env` ファイルを作成**  
   - 本番用のDB接続情報、JWT秘密鍵などを記述  
   - 例：`configs/api1.env`, `configs/api2.env`

3. **`.env` ファイルを ConoHa WING の公開ディレクトリ外にアップロード**  
   - 例：`/home/youruser/configs/`  
   - `public_html/` の中には置かないこと（Webからアクセス可能になるため）

4. **FastAPI を起動**  
   - 例：`uvicorn main:app --host 0.0.0.0 --port 8000`  
   - `.env` の内容が環境変数として読み込まれた状態で起動される

---

## 🧪 `.env.example` の配置と運用

各APIに対応する `.env.example` は `configs/` フォルダ内に配置しています。  
実際の `.env` は `.env.example` をコピーして値を設定してください。  
また、`.env` は Git に含めないようにしてください（`.gitignore` に追加）。

例：configs/
     ├── api1.env
     ├── api2.env

この構成により、環境変数の責務を明確にしつつ、設計と運用の一貫性を保っています。

---

## 🧠 設計構成と思想

- 各APIは独立した `main.py` を持ち、責務が分離されている  
- 共通モジュール `env_loader.py` により `.env` の読み込みを抽象化  
- `.env` は公開領域の外に置き、セキュリティを担保  
- 開発環境では Docker のDB、本番では ConoHa上のDBを使用  

この構成により、設計主権を保ちながら、安全かつ再利用可能なAPI群を効率的に運用できます。
